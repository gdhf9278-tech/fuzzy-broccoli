<!DOCTYPE html>
<html>
  <head>
    <title>Hello, World!</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
      <h1 class="title">Hello World! </h1>
      <p id="currentTime"></p>
      <script src="script.js"></script>
  </body>
</html><!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin App - Mobile Ready</title>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
<style>
body { font-family: Arial; background:#f0f8ff; padding:15px; font-size:14px; }
input, select, button { padding:10px; width:100%; margin:8px 0; font-size:14px; box-sizing:border-box; }
button { cursor:pointer; }
table { width:100%; border-collapse:collapse; margin-top:15px; }
th, td { border:1px solid #ddd; padding:8px; text-align:center; font-size:13px; }
tr.deleted { background-color:#ffe6e6; }
h2,h3 { color:#00796b; font-size:16px; }
#dashboard { display:none; }
</style>
</head>
<body>

<!-- Login Section -->
<div id="login">
<h2>ğŸ” Admin Login</h2>
<input type="email" id="email" placeholder="Email" value="vijaybhagat62074@gmail.com">
<input type="password" id="password" placeholder="Password" value="9815237898">
<button onclick="loginAdmin()">Login</button>
</div>

<!-- Dashboard Section -->
<div id="dashboard">
<h2>âœ… Welcome Admin</h2>
<button onclick="logoutAdmin()" style="background-color:red;color:white;">ğŸšª Logout</button>

<h3>â• Add New Customer</h3>
<input type="text" id="name" placeholder="Customer Name">
<input type="text" id="village" placeholder="Village Name">
<select id="type">
<option value="Wheat">Wheat (à¤—à¥‡à¤¹à¥‚à¤‚)</option>
<option value="Grain">Grain (à¤¦à¤¾à¤¨à¤¾)</option>
</select>
<input type="number" id="weight" placeholder="Weight (kg)">
<button onclick="saveCustomer()" style="background-color:lightgreen;">ğŸ’¾ Save Customer Data</button>

<h3>ğŸ“‹ Active Customer List</h3>
<table>
<thead>
<tr>
<th>Serial</th><th>Name</th><th>Village</th><th>Type</th><th>Weight</th><th>Action</th>
</tr>
</thead>
<tbody id="customerTable"></tbody>
</table>

<button onclick="toggleDeletedList()">ğŸ—‘ï¸ Show/Hide Deleted Customers</button>
<div id="deletedSection" style="display:none;">
<h3>ğŸ—‘ï¸ Deleted Customer List</h3>
<table>
<thead>
<tr>
<th>Serial</th><th>Name</th><th>Village</th><th>Type</th><th>Weight</th><th>Action</th>
</tr>
</thead>
<tbody id="deletedTable"></tbody>
</table>
</div>
</div>

<script>
const firebaseConfig = {
apiKey:"AIzaSyAj6dcL-zPijyQSNgRNuSjrYvT9RgGUFRA",
authDomain:"vkcustomerapp.firebaseapp.com",
databaseURL:"https://vkcustomerapp-default-rtdb.asia-southeast1.firebasedatabase.app",
projectId:"vkcustomerapp",
storageBucket:"vkcustomerapp.firebasestorage.app",
messagingSenderId:"385333707391",
appId:"1:385333707391:web:dea5dd3821b8fe5afbb54a",
measurementId:"G-6GHDNL5N5S"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

// Check login state
window.onload = () => {
auth.onAuthStateChanged(user => {
if(user){
document.getElementById('login').style.display='none';
document.getElementById('dashboard').style.display='block';
loadCustomerList();
loadDeletedList();
}else{
document.getElementById('login').style.display='block';
document.getElementById('dashboard').style.display='none';
}
});
};

// Login
function loginAdmin(){
const email = document.getElementById('email').value.trim();
const password = document.getElementById('password').value.trim();
if(!email || !password){ alert('âš ï¸ Email à¤”à¤° Password à¤¦à¥‹à¤¨à¥‹à¤‚ à¤­à¤°à¥‡à¤‚à¥¤'); return; }
auth.signInWithEmailAndPassword(email,password)
.then(()=>alert('âœ… Login Successful'))
.catch(error=>alert('âŒ Login Failed: '+error.message));
}

// Logout
function logoutAdmin(){ auth.signOut().then(()=>alert('ğŸšª Logged Out')); }

// Save Customer with automatic old delete
async function saveCustomer(){
  const name = document.getElementById('name').value.trim();
  const village = document.getElementById('village').value.trim();
  const type = document.getElementById('type').value;
  const weight = document.getElementById('weight').value.trim();
  if(!name || !village || !weight){ alert('âš ï¸ à¤¸à¤­à¥€ à¤«à¥€à¤²à¥à¤¡ à¤­à¤°à¥‡à¤‚à¥¤'); return; }

  const counterDoc = db.collection('metadata').doc('counter');
  try{
    const counterSnap = await counterDoc.get();
    let serial = 1;
    if(counterSnap.exists){
      serial = counterSnap.data().current + 1;
      if(serial > 200) serial = 1;
    }

    // Delete old customer if exists
    const oldDoc = await db.collection('customers').doc(String(serial)).get();
    if(oldDoc.exists){
      await db.collection('deleted_customers').doc(String(serial)).set(oldDoc.data());
    }

    // Save new customer
    await db.collection('customers').doc(String(serial)).set({serial,name,village,type,weight});
    await counterDoc.set({current:serial});

    alert(`âœ… Data Saved! Serial: ${serial}`);
    loadCustomerList();
    loadDeletedList();
    document.getElementById('name').value='';
    document.getElementById('village').value='';
    document.getElementById('weight').value='';
  }catch(error){ alert('âŒ Error: '+error.message); }
}

// Load Customers
async function loadCustomerList(){
const tableBody = document.getElementById('customerTable');
tableBody.innerHTML = '';
const snapshot = await db.collection('customers').orderBy('serial','desc').get();
snapshot.forEach(doc => {
const data = doc.data();
const row = document.createElement('tr');
row.innerHTML = `<td style="color:blue;font-weight:bold;">${data.serial}</td>
<td>${data.name}</td><td>${data.village}</td><td>${data.type}</td><td>${data.weight}</td>
<td><button onclick="deleteCustomer(${data.serial})" style="background-color:orange;">Delete</button></td>`;
tableBody.appendChild(row);
});
}

// Delete / Restore
function toggleDeletedList(){
const section = document.getElementById('deletedSection');
section.style.display = section.style.display==='none'?'block':'none';
}

async function loadDeletedList(){
const deletedBody = document.getElementById('deletedTable');
deletedBody.innerHTML = '';
const snapshot = await db.collection('deleted_customers').orderBy('serial','desc').get();
snapshot.forEach(doc => {
const data = doc.data();
const row = document.createElement('tr'); row.classList.add('deleted');
row.innerHTML = `<td style="color:red;font-weight:bold;">${data.serial}</td>
<td>${data.name}</td><td>${data.village}</td><td>${data.type}</td><td>${data.weight}</td>
<td><button onclick="restoreCustomer(${data.serial})" style="background-color:green;color:white;">Restore</button></td>`;
deletedBody.appendChild(row);
});
}

async function deleteCustomer(serial){
const docRef = db.collection('customers').doc(String(serial));
const docSnap = await docRef.get();
if(docSnap.exists){
await db.collection('deleted_customers').doc(String(serial)).set(docSnap.data());
await docRef.delete();
alert(`ğŸ—‘ï¸ Serial ${serial} Deleted.`);
loadCustomerList(); loadDeletedList();
}
}

async function restoreCustomer(serial){
const docRef = db.collection('deleted_customers').doc(String(serial));
const docSnap = await docRef.get();
if(docSnap.exists){
await db.collection('customers').doc(String(serial)).set(docSnap.data());
await docRef.delete();
alert(`â™»ï¸ Serial ${serial} Restored.`);
loadCustomerList(); loadDeletedList();
}
}
</script>
</body>
</html>